extra_srcs = [
    "../backtrace/src/**/*.rs",
    "../core/src/error.md",
    "../core/src/ffi/*.md",
    "../core/src/primitive_docs.rs",
    "../core/src/macros/panic.md",
    "../portable-simd/crates/core_simd/src/core_simd_docs.md",
    "../portable-simd/crates/std_float/**/*.rs",
    "../stdarch/crates/core_arch/src/core_arch_docs.md",
]

buildscript.run = true
rustc_flags = ["-Zforce-unstable-if-unmarked"]
preferred_linkage = "any"

['cfg(any(target_os = "linux", target_os = "macos", windows))']
omit_deps = ["panic_abort"]
extra_deps = [":panic_unwind-0.0.0"]

['cfg(all(target_arch = "nvptx64", target_vendor = "vectorware"))']
# Use the nvptx toolchain and hostcall-backed libc for the custom GPU target.
_rust_toolchain = "toolchains//:rust_nvptx"
default_target_platform = "//platforms/nvptx:library"
rustc_flags = [
    "-Zforce-unstable-if-unmarked",
    "--cfg",
    "unix",
    "--cfg",
    "target_env=\"gnu\"",
    "--cfg",
    "target_os=\"none\"",
]
rustc_env = { RUST_TARGET_PATH = "$(location //target_specs:nvptx64-vectorware-target-dir)" }
extra_deps = [
    "//hostcall-demo:libc_hostcall_nvptx",
    "//target_specs:nvptx64-vectorware-target-dir",
]
extra_srcs = [
    "fixups/std/nvptx_vectorware.rs",
    "fixups/std/sys/pal/unsupported/mod.rs",
    "fixups/std/sys/pal/unsupported/thread.rs",
    "fixups/std/sys/pal/unsupported/key.rs",
]
omit_deps = ["unwind-0.0.0", "panic_unwind-0.0.0"]
labels = ["generated"]
